---
import { getLangFromUrl,useTranslation } from "i18n/utils";

const lang = getLangFromUrl(Astro.url);
const t = useTranslation(lang);

const portfolioItems = [
  { title: "Serenity", path: "/portfolios" },
  { title: "Classic", path: "/portfolios" },
  { title: "Grow", path: "/portfolios" },
  { title: "Security", path: "/#portfolios-anchor" },
  { title: "Silver", path: "/#portfolios-anchor" },
  { title: "Gold", path: "/#portfolios-anchor" },
];

const contactItems = [
  { title: "Dep. Comercial", email: "sales@qqcapitalfund.com" },
  { title: "Dep. Marketing", email: "marketing@qqcapitalfund.com" },
  { title: "Dep. Finance", email: "finance@qqcapitalfund.com" },
];
---

<div class="dropdown-container flex bg-[#fafafa] rounded-md w-full h-[425px] md:h-[445px] lg:h-[530px] px-2 xl:px-10 xl:py-0 xl:h-[500px] mt-[25%] md:mt-[15%] lg:mt-24 flex-col animate-slide-down">
  <div class="bg-gray-200 h-[2px] w-full"></div>
  <button
    id="close-dropdown"
    class="absolute right-2 top-2 md:top-5 md:right-5 text-black text-4xl font-bold"
    >&times;</button
  >
  <!-- <button
    id="close-dropd"
    class="lg:hidden absolute right-2 top-2 md:top-5 md:right-5 text-black text-4xl font-bold"
    >&times;</button
  > -->

  <!-- Portafolios -->
  <div
    class="flex flex-col lg:flex-row mt-6 lg:mt-20 lg:space-x-20 text-[#0E1B4D]">
    <div class="portfolios">
      <h3 class="font-bold lg:text-xl mb-2">{t('nav.plans')}</h3>
      <ul class="grid lg:grid-cols-1 grid-cols-3 gap-1">
        {
          portfolioItems.map((item) => (
            <li class="mb-1">
              <a
                href={lang === 'en' ? item.path : '/es'+item.path}
                class="lg:text-xl hover:bg-gray-100 font-medium py-2 block">
                {item.title}
              </a>
            </li>
          ))
        }
      </ul>
    </div>

    <!-- Contacto -->
    <div class="contact text-[#0E1B4D] mt-2 lg:mt-0">
      <h3 class="font-bold text-base lg:text-xl mb-2">{t('nav.contact')}</h3>
      <ul>
        {
          contactItems.map((item) => (
            <li class="mb-1 relative group">
              <a class="lg:text-xl hover:bg-gray-100 font-medium py-2 block">
                {item.title}
              </a>
              <div class="email-tooltip hidden absolute left-0 p-2 bg-gray-200 rounded shadow-lg opacity-0 group-hover:block group-hover:opacity-100 transition-all duration-300 z-10">
                <span>{item.email}</span>
                <button class="ml-2 text-blue-600 underline cursor-pointer">
                  <li class="far fa-copy text-xl copy-btn" data-email={item.email}></li>             
                </button>
              </div>
            </li>
          ))
        }
      </ul>
    </div>
  </div>
</div>

<style>
  .dropdown-container {
    position: absolute;
    left: 0;
    z-index: 99;
    display: flex;
    animation: slide-down 0.5s ease-in-out;
  }

  @keyframes slide-down {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .email-tooltip {
    display: none;
    background-color: #f3f4f6;
    border-radius: 4px;
    padding: 0.5rem;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    white-space: nowrap;
    z-index: 10;
    transition: opacity 0.3s ease-in-out;
  }

  .group:hover .email-tooltip {
    display: block;
    opacity: 1;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const copyButtons = document.querySelectorAll(".copy-btn");

    copyButtons.forEach((button) => {
      button.addEventListener("click", (event) => {
        const email = (event.target as HTMLElement)?.getAttribute("data-email");
        if (email) {
          navigator.clipboard.writeText(email)
        }
      });
    });
  });
</script>
