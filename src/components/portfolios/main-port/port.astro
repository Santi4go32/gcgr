---
import { getLangFromUrl, useTranslation } from "i18n/utils";
import WNavbar from "components/navbar/w-navbar.astro";
import TitleSerenity from "@components/portfolios/main-port/titles/title-serenity.astro";
import Serenity from "@components/portfolios/main-port/serenity.astro";
import TitleClassic from "./titles/title-classic.astro";
import Classic from "./classic.astro";
import TitleGrow from "./titles//title-grow.astro";
import Grow from "./grow.astro";
import Faq from "@components/landing/faq.astro";

let isSerenityVisible = false;

function toggleSerenity() {
  isSerenityVisible = !isSerenityVisible;
}

const lang = getLangFromUrl(Astro.url);
const t = useTranslation(lang);
---

<main
  class="main_banner w-screen relative left-1/2 right-1/2 -ml-[50vw] -mr-[50vw] w-full">
  <div class="max-w-screen-xl mx-auto px-5 z-10 relative">
    <WNavbar />
  </div>
  <!-- Contenedor principal con fondo transparente -->
  <div class="flex justify-center z-1 relative">
    <div class="mw absolute flex w-full max-w-screen-xl px-4 py-2 justify-center">
      <div class="bg-[#0E1B4D] bg-opacity-60 pa p-2 xl:p-10 rounded-2xl what">
        <div class="carousel-container max-w-[350px] md:hidden relative fade-up">
          <!-- Carousel Items -->
          <div class="carousel-items w-auto flex transition-transform duration-300 text-white">
            <!-- Serenity Slide -->
            <div id="serenity-toggle" class="carousel-item bg-[#0E1B4D] bg-opacity-50 py-6 px-8 rounded-tl-2xl rounded-bl-2xl flex flex-col justify-between items-center text-center">
              <a href="#serenity" class="cursor-pointer">
                <h2 class="ti text-4xl font-bold">Serenity</h2>
                <p class="mt-12">{t("se.desc")}</p>
                <p class="mt-12">
                  {t("se.return")}
                  <span class="font-bold">10.98%</span>
                </p>
                <p class="mt-12">
                  {t("se.risk")}
                  <span class="font-bold">2%</span>
                </p>
              </a>
              <div class="flex justify-between w-full mt-20 px-12">
                <a href="#serenity">
                  <button class="text-white border-b border-white">{t("se.features")}</button>
                </a>
                <a href="#contact">
                  <button class="text-white border-b border-white">{t("investNow")}</button>
                </a>
              </div>
  
              <a href="#serenity" class="mt-6 cursor-pointer">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-6 w-6 text-white"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"></path>
                </svg>
              </a>
            </div>
        
            <!-- Classic Slide -->
            <div id="classic-toggle" class="carousel-item bg-[#292627] bg-opacity-70 py-6 px-8 rounded-none flex flex-col justify-between items-center text-center">
              <a href="#classic" class="cursor-pointer">
                <h2 class="ti text-4xl font-bold">Classic</h2>
                <p class="mt-12">{t("cl.desc")}</p>
                <p class="mt-12">
                  {t("se.return")}
                  <span class="font-bold">17.60%</span>
                </p>
                <p class="mt-12">
                  {t("se.risk")}
                  <span class="font-bold">6%</span>
                </p>
              </a>
              <div class="flex justify-between w-full mt-20 px-12">
                <a href="#classic">
                  <button class="text-white border-b border-white">{t("se.features")}</button>
                </a>
                <a href="#contact">
                  <button class="text-white border-b border-white">{t("investNow")}</button>
                </a>
              </div>
  
              <a href="#classic" class="mt-6 cursor-pointer">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-6 w-6 text-white"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"></path>
                </svg>
              </a>
            </div>
        
            <!-- Grow Slide -->
            <div id="grow-toggle" class="carousel-item bg-[#0E1B4D] bg-opacity-50 py-6 px-4 rounded-tr-2xl rounded-br-2xl flex flex-col justify-between items-center text-center">
              <a href="#grow" class="cursor-pointer">
                <h2 class="ti text-4xl font-bold">Grow</h2>
                <p class="mt-12">{t("gr.desc")}</p>
                <p class="mt-12">
                  {t("se.return")}
                  <span class="font-bold">35%</span>
                </p>
                <p class="mt-12">
                  {t("se.risk")}
                  <span class="font-bold">13%</span>
                </p>
              </a>
              <div class="flex justify-between w-full mt-20 px-16">
                <a href="#grow">
                  <button class="text-white border-b border-white">{t("se.features")}</button>
                </a>
                <a href="#contact">
                  <button class="text-white border-b border-white">{t("investNow")}</button>
                </a>
              </div>
  
              <a href="#grow" class="mt-6 cursor-pointer">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  class="h-6 w-6 text-white"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor">
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M19 9l-7 7-7-7"></path>
                </svg>
              </a>
            </div>
          </div>
        
          <!-- Navigation -->
          <button class="carousel-prev absolute left-0 top-1/2 transform -translate-y-1/2 bg-gray-800 text-white px-2 py-1">‹</button>
          <button class="carousel-next absolute right-0 top-1/2 transform -translate-y-1/2 bg-gray-800 text-white px-2 py-1">›</button>
        </div>

        <!-- Pantallas grandes -->
        <div class="pad hidden md:grid md:grid-cols-3 gap-0 text-white">
          <!-- Serenity Card -->
          <div id="serenity-togg" class="bg-[#0E1B4D] bg-opacity-50 py-6 px-8 rounded-tl-2xl rounded-bl-2xl flex flex-col justify-between items-center text-center">
            <a href="#serenity" class="cursor-pointer">
              <h2 class="ti text-4xl font-bold">Serenity</h2>
              <p class="mt-12">{t("se.desc")}</p>
              <p class="mt-12">
                {t("se.return")}
                <span class="font-bold">10.98%</span>
              </p>
              <p class="mt-12">
                {t("se.risk")}
                <span class="font-bold">2%</span>
              </p>
            </a>
            <div class="flex justify-between w-full mt-20 px-12">
              <a href="#serenity">
                <button class="text-white border-b border-white">{t("se.features")}</button>
              </a>
              <a href="#contact">
                <button class="text-white border-b border-white">{t("investNow")}</button>
              </a>
            </div>

            <a href="#serenity" class="mt-6 cursor-pointer">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6 text-white"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"></path>
              </svg>
            </a>
          </div>

          <!-- Classic Card -->
          <div id="classic-togg" class="bg-[#292627] bg-opacity-70 py-6 px-8 rounded-none flex flex-col justify-between items-center text-center">
            <a href="#classic" class="cursor-pointer">
              <h2 class="ti text-4xl font-bold">Classic</h2>
              <p class="mt-12">{t("cl.desc")}</p>
              <p class="mt-12">
                {t("se.return")}
                <span class="font-bold">17.60%</span>
              </p>
              <p class="mt-12">
                {t("se.risk")}
                <span class="font-bold">6%</span>
              </p>
            </a>
            <div class="flex justify-between w-full mt-20 px-12">
              <a href="#classic">
                <button class="text-white border-b border-white">{t("se.features")}</button>
              </a>
              <a href="#contact">
                <button class="text-white border-b border-white">{t("investNow")}</button>
              </a>
            </div>

            <a href="#classic" class="mt-6 cursor-pointer">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6 text-white"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"></path>
              </svg>
            </a>
          </div>

          <!-- Grow Card -->
          <div id="grow-togg" class="bg-[#0E1B4D] bg-opacity-50 py-6 px-4 rounded-tr-2xl rounded-br-2xl flex flex-col justify-between items-center text-center">
            <a href="#grow" class="cursor-pointer">
              <h2 class="ti text-4xl font-bold">Grow</h2>
              <p class="mt-12">{t("gr.desc")}</p>
              <p class="mt-12">
                {t("se.return")}
                <span class="font-bold">35%</span>
              </p>
              <p class="mt-12">
                {t("se.risk")}
                <span class="font-bold">13%</span>
              </p>
            </a>
            <div class="flex justify-between w-full mt-20 px-16">
              <a href="#grow">
                <button class="text-white border-b border-white">{t("se.features")}</button>
              </a>
              <a href="#contact">
                <button class="text-white border-b border-white">{t("investNow")}</button>
              </a>
            </div>

            <a href="#grow" class="mt-6 cursor-pointer">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-6 w-6 text-white"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor">
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"></path>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</main>

<div id="components">
  <div id="grow-components" class="an hidden w-full">
    <TitleGrow />
    <Grow />
  </div>

  <div id="serenity-components" class="an hidden w-full">
    <TitleSerenity />
    <Serenity />
  </div>

  <div id="classic-components" class="an hidden w-full">
    <TitleClassic />
    <Classic />
  </div>

  <div id="faq" class="hidden">
    <Faq />
  </div>
</div>

<style>
  .main_banner {
    background-image: url("https://res.cloudinary.com/dsfgyzics/image/upload/v1729030532/portfolios_ecbmf7.png");
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    height: 100vh;
  }

  @media (min-width: 1025px) and (min-height: 500px) and (max-height: 680px) {
    .mt-12 {
      margin-top: 40px;
    }

    .pa {
      padding: 20px;
    }

    .mt-20 {
      margin-top: 40px;
    }
  }

  .an {
    animation: slide-down 1s ease;
  }

  @keyframes slide-down {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @media (max-width: 1024px) and (max-height: 700px) {
    .pad {
      font-size: 10px;
    }

    .pa {
      padding: 10px;
    }

    .ti {
      font-size: 15px;
    }
  }

  @media (max-width: 360px) {
    .pa {
      padding: -2px;
    }

    .px-12 {
      padding-left: 20px;
      padding-right: 20px;
    }

    .px-16 {
      padding-left: 35px;
      padding-right: 35px;
    }

    .what {
      padding: 0px;
      width: 100%;
    }
  }

  .carousel-container {
    overflow: hidden; 
    position: relative;
    width: 100%; 
  }

  .carousel-items {
    display: flex; 
    width: 100%;
  }

  .carousel-item {
    flex: 0 0 100%;
  }

  .carousel-prev,
  .carousel-next {
    cursor: pointer;
  }

  @media (min-width: 2000px) and (min-height: 1040px) {
    .mw {
      max-width: 1800px;
      font-size: 25px;

      .ti {
        font-size: 80px;
      }

      .mt-12 {
        margin-top: 120px;
      }
    }
  }

  @media (min-width: 2050px) {
    .mw {
      max-width: 2000px;
      font-size: 25px;

      .ti {
        font-size: 80px;
      }

      .mt-12 {
        margin-top: 120px;
      }
    }
  }

</style>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const toggles = [
      { toggleId: "serenity-toggle", componentId: "serenity-components" },
      { toggleId: "classic-toggle", componentId: "classic-components" },
      { toggleId: "grow-toggle", componentId: "grow-components" },
      { toggleId: "serenity-togg", componentId: "serenity-components" },
      { toggleId: "classic-togg", componentId: "classic-components" },
      { toggleId: "grow-togg", componentId: "grow-components" }
    ];

    console.log("what")

    let currentVisibleComponent: HTMLElement | null = null;
    const faqElement = document.getElementById("faq");

    toggles.forEach(({ toggleId, componentId }) => {
      const toggleElement = document.getElementById(toggleId);
      const componentsElement = document.getElementById(componentId);

      toggleElement?.addEventListener("click", () => {
        console.log("oculto")
        if (
          currentVisibleComponent &&
          currentVisibleComponent !== componentsElement
        ) {
          currentVisibleComponent?.classList.add("hidden");
        }

        componentsElement?.classList.toggle("hidden");

        currentVisibleComponent = componentsElement?.classList.contains(
          "hidden",
        )
          ? null
          : (componentsElement as HTMLElement);

        // Si hay un componente visible, muestra el FAQ; si no, se oculta
        if (currentVisibleComponent) {
          faqElement?.classList.remove("hidden");
        } else {
          faqElement?.classList.add("hidden");
        }
      });
    });
  });
</script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const carouselItems = document.querySelector('.carousel-items');
    const carouselItem = document.querySelectorAll('.carousel-item');
    const prevButton = document.querySelector('.carousel-prev');
    const nextButton = document.querySelector('.carousel-next');
    
    let currentIndex = 0;
    const totalItems = carouselItem.length;
    
    function updateCarouselPosition() {
      const offset = -currentIndex * 100;
      if(carouselItems){
        (carouselItems as HTMLElement).style.transform = `translateX(${offset}%)`;
      }
    }

    // Next Button
    nextButton?.addEventListener('click', () => {
      currentIndex = (currentIndex + 1) % totalItems;
      updateCarouselPosition();
    });

    // Prev Button
    prevButton?.addEventListener('click', () => {
      currentIndex = (currentIndex - 1 + totalItems) % totalItems;
      updateCarouselPosition();
    });
  });
</script>
